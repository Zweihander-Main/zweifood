!function(y){function N(e){var t=e.originalEvent.changedTouches[0],a="";switch(e.type){case"touchmove":a="mousemove";break;case"touchend":a="mouseup";break;default:return}var i=document.createEvent("MouseEvent");i.initMouseEvent(a,!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(i),e.preventDefault()}y.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating"}},y.fn.rateit=function(f,g){var p=1,b={},w="init",x=function(e){return e.charAt(0).toUpperCase()+e.substr(1)};if(0===this.length)return this;var e=y.type(f);if("object"==e||null==f)b=y.extend({},y.fn.rateit.defaults,f);else{if("string"==e&&"reset"!==f&&void 0===g)return this.data("rateit"+x(f));"string"==e&&(w="setvalue")}return this.each(function(){var r=y(this),n=function(e,t){if(null!=t){var a="aria-value"+("value"==e?"now":e),i=r.find(".rateit-range");null!=i.attr(a)&&i.attr(a,t)}return e="rateit"+x(e),r.data.apply(r,arguments)};if("reset"==f){var e=n("init");for(var t in e)r.data(t,e[t]);if(n("backingfld"))(a=y(n("backingfld"))).val(n("value")),a.trigger("change"),a[0].min&&(a[0].min=n("min")),a[0].max&&(a[0].max=n("max")),a[0].step&&(a[0].step=n("step"));r.trigger("reset")}r.hasClass("rateit")||r.addClass("rateit");var i="rtl"!=r.css("direction");if("setvalue"==w){if(!n("init"))throw"Can't set value before init";if("readonly"!=f||1!=g||n("readonly")||(r.find(".rateit-range").unbind(),n("wired",!1)),"value"==f&&(g=null==g?n("min"):Math.max(n("min"),Math.min(n("max"),g))),n("backingfld")){var a=y(n("backingfld"));"value"==f&&a.val(g),"min"==f&&a[0].min&&(a[0].min=g),"max"==f&&a[0].max&&(a[0].max=g),"step"==f&&a[0].step&&(a[0].step=g)}n(f,g)}if(!n("init")){if(n("min",isNaN(n("min"))?b.min:n("min")),n("max",isNaN(n("max"))?b.max:n("max")),n("step",n("step")||b.step),n("readonly",void 0!==n("readonly")?n("readonly"):b.readonly),n("resetable",void 0!==n("resetable")?n("resetable"):b.resetable),n("backingfld",n("backingfld")||b.backingfld),n("starwidth",n("starwidth")||b.starwidth),n("starheight",n("starheight")||b.starheight),n("value",Math.max(n("min"),Math.min(n("max"),isNaN(n("value"))?isNaN(b.value)?b.min:b.value:n("value")))),n("ispreset",void 0!==n("ispreset")?n("ispreset"):b.ispreset),n("backingfld"))if(((a=y(n("backingfld")).hide()).attr("disabled")||a.attr("readonly"))&&n("readonly",!0),"INPUT"==a[0].nodeName&&("range"!=a[0].type&&"text"!=a[0].type||(n("min",parseInt(a.attr("min"))||n("min")),n("max",parseInt(a.attr("max"))||n("max")),n("step",parseInt(a.attr("step"))||n("step")))),"SELECT"==a[0].nodeName&&1<a[0].options.length){n("min",isNaN(n("min"))?Number(a[0].options[0].value):n("min")),n("max",Number(a[0].options[a[0].length-1].value)),n("step",Number(a[0].options[1].value)-Number(a[0].options[0].value));var s=a.find("option[selected]");1==s.length&&n("value",s.val())}else n("value",a.val());var l="DIV"==r[0].nodeName?"div":"span";p++;var d='<button id="rateit-reset-{{index}}" type="button" data-role="none" class="rateit-reset" aria-label="'+y.rateit.aria.resetLabel+'" aria-controls="rateit-range-{{index}}"></button><{{element}} id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+y.rateit.aria.ratingLabel+'" aria-owns="rateit-reset-{{index}}" aria-valuemin="'+n("min")+'" aria-valuemax="'+n("max")+'" aria-valuenow="'+n("value")+'"><{{element}} class="rateit-selected" style="height:'+n("starheight")+'px"></{{element}}><{{element}} class="rateit-hover" style="height:'+n("starheight")+'px"></{{element}}></{{element}}>';r.append(d.replace(/{{index}}/gi,p).replace(/{{element}}/gi,l)),i||(r.find(".rateit-reset").css("float","right"),r.find(".rateit-selected").addClass("rateit-selected-rtl"),r.find(".rateit-hover").addClass("rateit-hover-rtl")),n("init",JSON.parse(JSON.stringify(r.data())))}r.find(".rateit-selected, .rateit-hover").height(n("starheight"));var h=r.find(".rateit-range");h.width(n("starwidth")*(n("max")-n("min"))).height(n("starheight"));var o="rateit-preset"+(i?"":"-rtl");if(n("ispreset")?r.find(".rateit-selected").addClass(o):r.find(".rateit-selected").removeClass(o),null!=n("value")){var u=(n("value")-n("min"))*n("starwidth");r.find(".rateit-selected").width(u)}var v=r.find(".rateit-reset");!0!==v.data("wired")&&v.bind("click",function(e){e.preventDefault(),v.blur();var t=y.Event("beforereset");if(r.trigger(t),t.isDefaultPrevented())return!1;r.rateit("value",null),r.trigger("reset")}).data("wired",!0);var m=function(e,t){var a=(t.changedTouches?t.changedTouches[0].pageX:t.pageX)-y(e).offset().left;return i||(a=h.width()-a),a>h.width()&&(a=h.width()),a<0&&(a=0),u=Math.ceil(a/n("starwidth")*(1/n("step")))},c=function(e){var t=y.Event("beforerated");return r.trigger(t,[e]),!t.isDefaultPrevented()&&(n("value",e),n("backingfld")&&y(n("backingfld")).val(e).trigger("change"),n("ispreset")&&(h.find(".rateit-selected").removeClass(o),n("ispreset",!1)),h.find(".rateit-hover").hide(),h.find(".rateit-selected").width(e*n("starwidth")-n("min")*n("starwidth")).show(),r.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[e]),!0)};n("readonly")?v.hide():(n("resetable")||v.hide(),n("wired")||(h.bind("touchmove touchend",N),h.mousemove(function(e){!function(e){var t=e*n("starwidth")*n("step"),a=h.find(".rateit-hover");if(a.data("width")!=t){h.find(".rateit-selected").hide(),a.width(t).show().data("width",t);var i=[e*n("step")+n("min")];r.trigger("hover",i).trigger("over",i)}}(m(this,e))}),h.mouseleave(function(e){h.find(".rateit-hover").hide().width(0).data("width",""),r.trigger("hover",[null]).trigger("over",[null]),h.find(".rateit-selected").show()}),h.mouseup(function(e){var t=m(this,e)*n("step")+n("min");c(t),h.blur()}),h.keyup(function(e){38!=e.which&&e.which!=(i?39:37)||c(Math.min(n("value")+n("step"),n("max"))),40!=e.which&&e.which!=(i?37:39)||c(Math.max(n("value")-n("step"),n("min")))}),n("wired",!0)),n("resetable")&&v.show()),h.attr("aria-readonly",n("readonly"))})},y.fn.rateit.defaults={min:0,max:5,step:.5,starwidth:16,starheight:16,readonly:!1,resetable:!0,ispreset:!1},y(function(){y("div.rateit, span.rateit").rateit()})}(jQuery);