!function(y){function N(e){var t,a=e.originalEvent.changedTouches[0],i="";switch(e.type){case"touchmove":i="mousemove";break;case"touchend":i="mouseup";break;default:return}(t=document.createEvent("MouseEvent")).initMouseEvent(i,!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(t),e.preventDefault()}y.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating"}},y.fn.rateit=function(g,f){var e,p=1,b={},w="init",x=function(e){return e.charAt(0).toUpperCase()+e.substr(1)};if(0===this.length)return this;if("object"==(e=y.type(g))||null==g)b=y.extend({},y.fn.rateit.defaults,g);else{if("string"==e&&"reset"!==g&&void 0===f)return this.data("rateit"+x(g));"string"==e&&(w="setvalue")}return this.each(function(){var e,t,i,a,r,n,s,l,d,h,o,u=y(this),m=function(e,t){if(null!=t){var a="aria-value"+("value"==e?"now":e),i=u.find(".rateit-range");null!=i.attr(a)&&i.attr(a,t)}return e="rateit"+x(e),u.data.apply(u,arguments)};if("reset"==g){for(t in e=m("init"))u.data(t,e[t]);m("backingfld")&&((a=y(m("backingfld"))).val(m("value")),a.trigger("change"),a[0].min&&(a[0].min=m("min")),a[0].max&&(a[0].max=m("max")),a[0].step&&(a[0].step=m("step"))),u.trigger("reset")}if(u.hasClass("rateit")||u.addClass("rateit"),i="rtl"!=u.css("direction"),"setvalue"==w){if(!m("init"))throw"Can't set value before init";"readonly"!=g||1!=f||m("readonly")||(u.find(".rateit-range").unbind(),m("wired",!1)),"value"==g&&(f=null==f?m("min"):Math.max(m("min"),Math.min(m("max"),f))),m("backingfld")&&(a=y(m("backingfld")),"value"==g&&a.val(f),"min"==g&&a[0].min&&(a[0].min=f),"max"==g&&a[0].max&&(a[0].max=f),"step"==g&&a[0].step&&(a[0].step=f)),m(g,f)}m("init")||(m("min",isNaN(m("min"))?b.min:m("min")),m("max",isNaN(m("max"))?b.max:m("max")),m("step",m("step")||b.step),m("readonly",void 0!==m("readonly")?m("readonly"):b.readonly),m("resetable",void 0!==m("resetable")?m("resetable"):b.resetable),m("backingfld",m("backingfld")||b.backingfld),m("starwidth",m("starwidth")||b.starwidth),m("starheight",m("starheight")||b.starheight),m("value",Math.max(m("min"),Math.min(m("max"),isNaN(m("value"))?isNaN(b.value)?b.min:b.value:m("value")))),m("ispreset",void 0!==m("ispreset")?m("ispreset"):b.ispreset),m("backingfld")&&(((a=y(m("backingfld")).hide()).attr("disabled")||a.attr("readonly"))&&m("readonly",!0),"INPUT"==a[0].nodeName&&("range"==a[0].type||"text"==a[0].type)&&(m("min",parseInt(a.attr("min"))||m("min")),m("max",parseInt(a.attr("max"))||m("max")),m("step",parseInt(a.attr("step"))||m("step"))),"SELECT"==a[0].nodeName&&1<a[0].options.length?(m("min",isNaN(m("min"))?Number(a[0].options[0].value):m("min")),m("max",Number(a[0].options[a[0].length-1].value)),m("step",Number(a[0].options[1].value)-Number(a[0].options[0].value)),1==(r=a.find("option[selected]")).length&&m("value",r.val())):m("value",a.val())),n="DIV"==u[0].nodeName?"div":"span",p++,s='<button id="rateit-reset-{{index}}" type="button" data-role="none" class="rateit-reset" aria-label="'+y.rateit.aria.resetLabel+'" aria-controls="rateit-range-{{index}}"></button><{{element}} id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+y.rateit.aria.ratingLabel+'" aria-owns="rateit-reset-{{index}}" aria-valuemin="'+m("min")+'" aria-valuemax="'+m("max")+'" aria-valuenow="'+m("value")+'"><{{element}} class="rateit-selected" style="height:'+m("starheight")+'px"></{{element}}><{{element}} class="rateit-hover" style="height:'+m("starheight")+'px"></{{element}}></{{element}}>',u.append(s.replace(/{{index}}/gi,p).replace(/{{element}}/gi,n)),i||(u.find(".rateit-reset").css("float","right"),u.find(".rateit-selected").addClass("rateit-selected-rtl"),u.find(".rateit-hover").addClass("rateit-hover-rtl")),m("init",JSON.parse(JSON.stringify(u.data())))),u.find(".rateit-selected, .rateit-hover").height(m("starheight")),(l=u.find(".rateit-range")).width(m("starwidth")*(m("max")-m("min"))).height(m("starheight")),d="rateit-preset"+(i?"":"-rtl"),m("ispreset")?u.find(".rateit-selected").addClass(d):u.find(".rateit-selected").removeClass(d),null!=m("value")&&(h=(m("value")-m("min"))*m("starwidth"),u.find(".rateit-selected").width(h)),!0!==(o=u.find(".rateit-reset")).data("wired")&&o.bind("click",function(e){e.preventDefault(),o.blur();var t=y.Event("beforereset");if(u.trigger(t),t.isDefaultPrevented())return!1;u.rateit("value",null),u.trigger("reset")}).data("wired",!0);var v=function(e,t){var a=(t.changedTouches?t.changedTouches[0].pageX:t.pageX)-y(e).offset().left;return i||(a=l.width()-a),a>l.width()&&(a=l.width()),a<0&&(a=0),h=Math.ceil(a/m("starwidth")*(1/m("step")))},c=function(e){var t=y.Event("beforerated");return u.trigger(t,[e]),!t.isDefaultPrevented()&&(m("value",e),m("backingfld")&&y(m("backingfld")).val(e).trigger("change"),m("ispreset")&&(l.find(".rateit-selected").removeClass(d),m("ispreset",!1)),l.find(".rateit-hover").hide(),l.find(".rateit-selected").width(e*m("starwidth")-m("min")*m("starwidth")).show(),u.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[e]),!0)};m("readonly")?o.hide():(m("resetable")||o.hide(),m("wired")||(l.bind("touchmove touchend",N),l.mousemove(function(e){var t,a,i,r,n=v(this,e);i=(t=n)*m("starwidth")*m("step"),(r=l.find(".rateit-hover")).data("width")!=i&&(l.find(".rateit-selected").hide(),r.width(i).show().data("width",i),a=[t*m("step")+m("min")],u.trigger("hover",a).trigger("over",a))}),l.mouseleave(function(){l.find(".rateit-hover").hide().width(0).data("width",""),u.trigger("hover",[null]).trigger("over",[null]),l.find(".rateit-selected").show()}),l.mouseup(function(e){var t=v(this,e)*m("step")+m("min");c(t),l.blur()}),l.keyup(function(e){(38==e.which||e.which==(i?39:37))&&c(Math.min(m("value")+m("step"),m("max"))),(40==e.which||e.which==(i?37:39))&&c(Math.max(m("value")-m("step"),m("min")))}),m("wired",!0)),m("resetable")&&o.show()),l.attr("aria-readonly",m("readonly"))})},y.fn.rateit.defaults={min:0,max:5,step:.5,starwidth:16,starheight:16,readonly:!1,resetable:!0,ispreset:!1},y(function(){y("div.rateit, span.rateit").rateit()})}(jQuery);