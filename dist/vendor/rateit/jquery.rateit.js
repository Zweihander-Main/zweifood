!function(e){function t(e){var t=e.originalEvent.changedTouches,a=t[0],i="";switch(e.type){case"touchmove":i="mousemove";break;case"touchend":i="mouseup";break;default:return}var r=document.createEvent("MouseEvent");r.initMouseEvent(i,!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(r),e.preventDefault()}e.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating"}},e.fn.rateit=function(a,i){var r=1,n={},s="init",l=function(e){return e.charAt(0).toUpperCase()+e.substr(1)};if(0===this.length)return this;var d=e.type(a);if("object"==d||void 0===a||null===a)n=e.extend({},e.fn.rateit.defaults,a);else{if("string"==d&&"reset"!==a&&void 0===i)return this.data("rateit"+l(a));"string"==d&&(s="setvalue")}return this.each(function(){var d=e(this),h=function(e,t){if(null!=t){var a="aria-value"+("value"==e?"now":e),i=d.find(".rateit-range");void 0!=i.attr(a)&&i.attr(a,t)}return arguments[0]="rateit"+l(e),d.data.apply(d,arguments)};if("reset"==a){var o=h("init");for(var v in o)d.data(v,o[v]);if(h("backingfld")){var u=e(h("backingfld"));u.val(h("value")),u.trigger("change"),u[0].min&&(u[0].min=h("min")),u[0].max&&(u[0].max=h("max")),u[0].step&&(u[0].step=h("step"))}d.trigger("reset")}d.hasClass("rateit")||d.addClass("rateit");var m="rtl"!=d.css("direction");if("setvalue"==s){if(!h("init"))throw"Can't set value before init";if("readonly"!=a||1!=i||h("readonly")||(d.find(".rateit-range").unbind(),h("wired",!1)),"value"==a&&(i=null==i?h("min"):Math.max(h("min"),Math.min(h("max"),i))),h("backingfld")){var u=e(h("backingfld"));"value"==a&&u.val(i),"min"==a&&u[0].min&&(u[0].min=i),"max"==a&&u[0].max&&(u[0].max=i),"step"==a&&u[0].step&&(u[0].step=i)}h(a,i)}if(!h("init")){if(h("min",isNaN(h("min"))?n.min:h("min")),h("max",isNaN(h("max"))?n.max:h("max")),h("step",h("step")||n.step),h("readonly",void 0!==h("readonly")?h("readonly"):n.readonly),h("resetable",void 0!==h("resetable")?h("resetable"):n.resetable),h("backingfld",h("backingfld")||n.backingfld),h("starwidth",h("starwidth")||n.starwidth),h("starheight",h("starheight")||n.starheight),h("value",Math.max(h("min"),Math.min(h("max"),isNaN(h("value"))?isNaN(n.value)?n.min:n.value:h("value")))),h("ispreset",void 0!==h("ispreset")?h("ispreset"):n.ispreset),h("backingfld")){var u=e(h("backingfld")).hide();if((u.attr("disabled")||u.attr("readonly"))&&h("readonly",!0),"INPUT"==u[0].nodeName&&("range"!=u[0].type&&"text"!=u[0].type||(h("min",parseInt(u.attr("min"))||h("min")),h("max",parseInt(u.attr("max"))||h("max")),h("step",parseInt(u.attr("step"))||h("step")))),"SELECT"==u[0].nodeName&&u[0].options.length>1){h("min",isNaN(h("min"))?Number(u[0].options[0].value):h("min")),h("max",Number(u[0].options[u[0].length-1].value)),h("step",Number(u[0].options[1].value)-Number(u[0].options[0].value));var c=u.find("option[selected]");1==c.length&&h("value",c.val())}else h("value",u.val())}var g="DIV"==d[0].nodeName?"div":"span";r++;var f='<button id="rateit-reset-{{index}}" type="button" data-role="none" class="rateit-reset" aria-label="'+e.rateit.aria.resetLabel+'" aria-controls="rateit-range-{{index}}"></button><{{element}} id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+e.rateit.aria.ratingLabel+'" aria-owns="rateit-reset-{{index}}" aria-valuemin="'+h("min")+'" aria-valuemax="'+h("max")+'" aria-valuenow="'+h("value")+'"><{{element}} class="rateit-selected" style="height:'+h("starheight")+'px"></{{element}}><{{element}} class="rateit-hover" style="height:'+h("starheight")+'px"></{{element}}></{{element}}>';d.append(f.replace(/{{index}}/gi,r).replace(/{{element}}/gi,g)),m||(d.find(".rateit-reset").css("float","right"),d.find(".rateit-selected").addClass("rateit-selected-rtl"),d.find(".rateit-hover").addClass("rateit-hover-rtl")),h("init",JSON.parse(JSON.stringify(d.data())))}d.find(".rateit-selected, .rateit-hover").height(h("starheight"));var p=d.find(".rateit-range");p.width(h("starwidth")*(h("max")-h("min"))).height(h("starheight"));var b="rateit-preset"+(m?"":"-rtl");if(h("ispreset")?d.find(".rateit-selected").addClass(b):d.find(".rateit-selected").removeClass(b),null!=h("value")){var w=(h("value")-h("min"))*h("starwidth");d.find(".rateit-selected").width(w)}var x=d.find(".rateit-reset");x.data("wired")!==!0&&x.bind("click",function(t){t.preventDefault(),x.blur();var a=e.Event("beforereset");return d.trigger(a),!a.isDefaultPrevented()&&(d.rateit("value",null),void d.trigger("reset"))}).data("wired",!0);var y=function(t,a){var i=a.changedTouches?a.changedTouches[0].pageX:a.pageX,r=i-e(t).offset().left;return m||(r=p.width()-r),r>p.width()&&(r=p.width()),r<0&&(r=0),w=Math.ceil(r/h("starwidth")*(1/h("step")))},N=function(e){var t=e*h("starwidth")*h("step"),a=p.find(".rateit-hover");if(a.data("width")!=t){p.find(".rateit-selected").hide(),a.width(t).show().data("width",t);var i=[e*h("step")+h("min")];d.trigger("hover",i).trigger("over",i)}},k=function(t){var a=e.Event("beforerated");return d.trigger(a,[t]),!a.isDefaultPrevented()&&(h("value",t),h("backingfld")&&e(h("backingfld")).val(t).trigger("change"),h("ispreset")&&(p.find(".rateit-selected").removeClass(b),h("ispreset",!1)),p.find(".rateit-hover").hide(),p.find(".rateit-selected").width(t*h("starwidth")-h("min")*h("starwidth")).show(),d.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[t]),!0)};h("readonly")?x.hide():(h("resetable")||x.hide(),h("wired")||(p.bind("touchmove touchend",t),p.mousemove(function(e){var t=y(this,e);N(t)}),p.mouseleave(function(e){p.find(".rateit-hover").hide().width(0).data("width",""),d.trigger("hover",[null]).trigger("over",[null]),p.find(".rateit-selected").show()}),p.mouseup(function(e){var t=y(this,e),a=t*h("step")+h("min");k(a),p.blur()}),p.keyup(function(e){38!=e.which&&e.which!=(m?39:37)||k(Math.min(h("value")+h("step"),h("max"))),40!=e.which&&e.which!=(m?37:39)||k(Math.max(h("value")-h("step"),h("min")))}),h("wired",!0)),h("resetable")&&x.show()),p.attr("aria-readonly",h("readonly"))})},e.fn.rateit.defaults={min:0,max:5,step:.5,starwidth:16,starheight:16,readonly:!1,resetable:!0,ispreset:!1},e(function(){e("div.rateit, span.rateit").rateit()})}(jQuery);