var app=function(){function e(e,o){var t=[];for(i=0,length=e.length;i<length;++i)t[i]=new Image,t[i].src=e[i];"function"==typeof o&&o()}function o(e){for(var o=Array.prototype.slice.call(arguments,1),t=0;t<o.length;t++){if(!e||!e.hasOwnProperty(o[t]))return!1;e=e[o[t]]}return!0}function t(e,o,t){var r,n,a,i,l,s=function(){var c=_now()-i;o>c&&c>=0?r=setTimeout(s,o-c):(r=null,t||(l=e.apply(a,n),r||(a=n=null)))};return function(){a=this,n=arguments,i=_now();var c=t&&!r;return r||(r=setTimeout(s,o)),c&&(l=e.apply(a,n),a=n=null),l}}function r(e,o,t){var r,n,a,i=null,l=0;t||(t={});var s=function(){l=t.leading===!1?0:_now(),i=null,a=e.apply(r,n),i||(r=n=null)};return function(){var c=_now();l||t.leading!==!1||(l=c);var u=o-(c-l);return r=this,n=arguments,0>=u||u>o?(i&&(clearTimeout(i),i=null),l=c,a=e.apply(r,n),i||(r=n=null)):i||t.trailing===!1||(i=setTimeout(s,u)),a}}function n(e,o,t){"undefined"==typeof t&&(t="name");for(var r=FuzzySet([]),n=0;n<e.length;n++)r.add(e[n][t]);var a=r.get(o);return null!==a&&a[0][0]>appConfigObject.minFuzzyMatch?r.values().indexOf(a[0][1]):!1}function a(e,o){for(var t=0;t<e.length;t++)if(e[t]!==o[t])return!1;return!0}function l(e){try{var o=window[e],t="__storage_test__";return o.setItem(t,t),o.removeItem(t),!0}catch(r){return!1}}function s(){return"undefined"!=typeof Worker&&"file:"!==window.location.protocol?!0:!1}function c(e,t,r,n,a,i){if("undefined"==typeof e||null===e)return!1;if(e.constructor===Array){if("undefined"==typeof e[0])return!1;if(o.apply(this,e)!==!0)return!1;for(var l=e[0],s=1;s<e.length;s++)l=l[e[s]];e=l}return"undefined"!=typeof t&&(e=ko.bindingHandlers[t].update(r,e,n,a,i,!0)),e}function u(e,o){e.hide(o,function(){e.unbind("click",d),e.remove()})}function d(e){u($(e.currentTarget),50)}function p(e,o){I($(o)),g(o)}function g(e){$(e).unbind("mouseenter",p)}function f(e,o){var t=this;t.googleSearchType=ko.observable(o),t.googleIsLoading=ko.observable(!1),t.isInViewOnMap=ko.observable(!0),t.isListed=ko.observable(!1),t.isSelected=ko.observable(!1),t.hasBeenOpened=!1,t.modelNumber=e.getLocationModelNumber(),t.isFavorite=ko.observable(!1),t.disposableArray=[],t.listenerStorage=[],e.modelConstructor(t),e.modelSearchTypeConstructor(t),t.marker=ko.observable(new google.maps.Marker({map:e.mainMap,opacity:t.isListed()===!1?e.lowMarkerOpacity():appConfigObject.highMarkerOpacity,icon:e.markerImageCreator(),shape:appConfigObject.defaultMarkerShape})),t.disposableArray.push(t.isFavorite.subscribe(function(o){t.marker().setIcon(e.markerImageCreator(o,t.google_priceLevel())),t.marker(t.marker()),e.changeFavoriteArray(o,t)})),t.disposableArray.push(t.isSelected.subscribe(function(o){e.changeCurrentlySelectedItem(o,t)})),t.disposableArray.push(t.isListed.subscribe(function(o){o?(t.marker().setOpacity(appConfigObject.highMarkerOpacity),t.marker(t.marker())):(t.marker().setOpacity(e.lowMarkerOpacity()),t.marker(t.marker()))})),t.disposableArray.push(t.google_priceLevel.subscribe(function(o){t.marker().setIcon(e.markerImageCreator(t.isFavorite(),o)),t.marker(t.marker())})),t.disposableArray.push(t.google_name.subscribe(function(e){t.marker().setTitle(e),t.marker(t.marker())})),t.disposableArray.push(t.google_geometry.subscribe(function(e){t.marker().setPosition(e.location),t.marker(t.marker())})),t.isItOpenRightNow=ko.pureComputed(function(){if("undefined"!=typeof t.google_openingHoursObject()){if(t.google_openingHoursObject().open_now===!0)return"Open";if(t.google_openingHoursObject().open_now===!1)return"Closed"}}),t.infoWindow=new google.maps.InfoWindow({content:e.makeInfoWindowContent()}),t.listenerStorage.push(t.infoWindow.addListener("closeclick",e.markerCloseClick)),t.listenerStorage.push(t.infoWindow.addListener("domready",e.markerDomReady)),t.listenerStorage.push(t.marker().addListener("click",function(){e.markerClick(t)})),t.listWasClicked=function(){new google.maps.event.trigger(t.marker(),"click"),t.marker().map.panTo(t.google_geometry().location)},t.searchType=function(e){return t[e.toLowerCase()+"SearchType"]},t.dispose=function(){t.marker().setMap(null),ko.utils.arrayForEach(t.disposableArray,function(e){e.dispose()}),ko.utils.arrayForEach(t.listenerStorage,function(e){google.maps.event.removeListener(e)})}}function m(e){var i=this;i.mainMap=e,i.mainMapCenter=ko.observable(),i.service=new google.maps.places.PlacesService(i.mainMap),i.storageAvailable=l("localStorage"),i.workersAvailable=s(),i.maxMarkerLimit=ko.observable(appConfigObject.maxMarkerLimit),i.lowMarkerOpacity=ko.observable(appConfigObject.lowMarkerOpacity),i.APIMappingsForModel=appConfigObject.APIMappingsForModel,i.APIConfiguredSearchTypes=appConfigObject.configuredSearchTypes,i.defaultMarkerImage={size:new google.maps.Size(appConfigObject.markerImageSize[0],appConfigObject.markerImageSize[1]),origin:new google.maps.Point(appConfigObject.markerImageOrigin[0],appConfigObject.markerImageOrigin[1]),anchor:new google.maps.Point(appConfigObject.markerImageAnchor[0],appConfigObject.markerImageAnchor[1])},i.markedLocations=ko.observableArray([]),i.locationModelNumber=0,i.currentlySelectedLocation=ko.observable(),i.scrolledItem=ko.observable(),i.shouldScroll=ko.observable(!1),i.attributionsArray=ko.observableArray([]),i.favoriteArray=ko.observableArray([]),i.getRestaurantsFromGoogleMapsAPICallArray=[],i.currentDetailedAPIInfoBeingFetched={},i.errors=ko.observable(!1),i.verboseErrors=ko.observable(!1),i.checkNested=o,i.sortType=ko.observable("count"),i.searchQuery=ko.observable(),i.priceButtonFilter=ko.observableArray([!0,!0,!0,!0,!0]),i.minRatingButtonFilter=ko.observable(0),i.openButtonFilter=ko.observable(!1),i.favoriteButtonFilter=ko.observable(!1),i.infoWindowHTMLTemplate='<div class = "info-window-template" data-bind = "infoWindowTemplate: true"></div>',i.lowMarkerOpacity.subscribe(function(e){e=Number(e).toFixed(2)/1,ko.utils.arrayForEach(i.markedLocations(),function(o){o.isListed()===!1&&o.marker().setOpacity(e)})}),i.lowMarkerOpacity.extend({numeric:2}),i.mainMapCenter.subscribe(function(e){i.setLocalStorage("mapCenter",JSON.stringify({lat:e.lat(),lng:e.lng(),zoom:i.mainMap.getZoom()}))}),i.markedLocations.subscribe(function(e){e.length>i.maxMarkerLimit()&&i.removeMultipleLocations(e)}),i.favoriteArray.subscribe(function(e){var o=[];ko.utils.arrayForEach(e,function(e){o.push(i.modelDeconstructor(e))});var t=JSON.stringify(o);0!==o.length?i.setLocalStorage("favoritesArray",t):i.setLocalStorage("favoritesArray","[]")}),i.favoriteArray.extend({rateLimit:2e3}),i.currentlySelectedLocation.subscribe(t(function(e){"undefined"!=typeof e&&i.scrollToItem()},5)),i.idArray=ko.pureComputed(function(){var e={all:[],nearby:[]};return ko.utils.arrayMap(i.markedLocations(),function(o){("Nearby"===o.googleSearchType()||"Places"===o.googleSearchType())&&e.nearby.push(o.google_placeId),e.all.push(o.google_placeId)}),e}),i.priceButtonFilterHasChanged=ko.pureComputed(function(){return!a(i.priceButtonFilter(),[!0,!0,!0,!0,!0])}),i.listableEntries=ko.computed(function(){var e={entries:[],allNames:[]};return e.entries=ko.utils.arrayFilter(i.markedLocations(),function(o){return"Nearby"!==o.googleSearchType()&&"Places"!==o.googleSearchType()||o.isInViewOnMap()!==!0||i.isSearchFiltered(o)!==!1||i.isButtonFiltered(o)!==!1?(o.isListed(!1),!1):(o.isListed(!0),e.allNames.push(o.google_name()),!0)}),e}),i.sortedEntries=ko.pureComputed(function(){var e=i.listableEntries().entries;return"count"===i.sortType()?e.sort(function(e,o){return e.modelNumber<o.modelNumber?-1:1}):"alpha"===i.sortType()?e.sort(function(e,o){return e.google_name()===o.google_name()?0:e.google_name()<o.google_name()?-1:1}):"rating"===i.sortType()?e.sort(function(e,o){return"undefined"==typeof e.google_rating()?"undefined"==typeof o.google_rating()?0:1:"undefined"==typeof o.google_rating()?-1:e.google_rating()<o.google_rating()?1:-1}):"distance"===i.sortType()&&e.sort(function(e,o){var t=e.google_geometry().location.lat(),r=o.google_geometry().location.lat(),n=i.mainMapCenter().lat(),a=e.google_geometry().location.lng(),l=o.google_geometry().location.lng(),s=i.mainMapCenter().lng(),c=appConfigObject.distanceBetweenTwoPointsInMeters(t,a,n,s),u=appConfigObject.distanceBetweenTwoPointsInMeters(r,l,n,s);return c===u?0:u>c?-1:1}),e}),i.listableEntries.extend({rateLimit:50}),i.initializeCurrentDetailedAPIInfoBeingFetched=function(){i.currentDetailedAPIInfoBeingFetched.findID=function(e,o,t){return this[e][o].indexOf(t)},i.currentDetailedAPIInfoBeingFetched.pushID=function(e,o,t){this[e][o].push(t),this[e][o][this[e][o].length-1][e+"IsLoading"](!0)},i.currentDetailedAPIInfoBeingFetched.removeID=function(e,o,t){var r=this.findID(e,o,t);r>-1&&(this[e][o][r][e+"IsLoading"](!1),this[e][o].splice(r,1));for(var n=0;n<this.intercept.length;n++)this.intercept[n].ID===t&&(i.getDetailedAPIData(this.intercept[n].service,this.intercept[n].ID),this.intercept.splice(n,1))},i.currentDetailedAPIInfoBeingFetched.intercept=[],i.currentDetailedAPIInfoBeingFetched.interceptIDPush=function(e,o,t){for(var r=0;r<this.intercept.length;r++)if(this.intercept.ID===t)return;this.intercept.push({ID:t,type:o,service:e})},i.currentDetailedAPIInfoBeingFetched.interceptIDRemove=function(e){for(var o=0;o<this.intercept.length;o++)this.intercept.ID===e&&this.intercept.splice(o,1)};for(var e=0;e<i.APIConfiguredSearchTypes.length;e++)i.currentDetailedAPIInfoBeingFetched[i.APIConfiguredSearchTypes[e]]={basic:[],detailed:[]};i.currentDetailedAPIInfoBeingFetched.google={detailed:[]}},i.changeCurrentlySelectedItem=function(e,o){e===!0?i.currentlySelectedLocation(o):i.currentlySelectedLocation(void 0)},i.changeFavoriteArray=function(e,o){e===!0?i.favoriteArray.push(o):i.favoriteArray.remove(o)},i.markerCloseClick=function(){i.currentlySelectedLocation().isSelected(!1)},i.markerDomReady=function(){i.currentlySelectedLocation().hasBeenOpened||(ko.applyBindings(i,i.currentlySelectedLocation().infoWindow.getContent()),i.currentlySelectedLocation().hasBeenOpened=!0)},i.markerClick=function(e){i.shouldScroll(!0),i.getDetailedGooglePlacesAPIInfo(e,i.callSearchAPIs),"undefined"!=typeof i.currentlySelectedLocation()&&(i.currentlySelectedLocation().infoWindow.close(),i.currentlySelectedLocation().isSelected(!1)),e.isSelected(!0),i.markerAnimation(e),e.infoWindow.open(e.marker().map,e.marker())},i.markerAnimation=function(e){e.marker().setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.marker().setAnimation(null)},750)},i.markerImageCreator=function(e,o){var t=i.defaultMarkerImage;if(e===!0)return t.url=appConfigObject.markerImageURLFav,t;switch(o){case 1:return t.url=appConfigObject.markerImageURL1,t;case 2:return t.url=appConfigObject.markerImageURL2,t;case 3:return t.url=appConfigObject.markerImageURL3,t;case 4:return t.url=appConfigObject.markerImageURL4,t;default:return t.url=appConfigObject.markerImageURLEmpty,t}return t.url=appConfigObject.markerImageURLEmpty,t},i.getNavWithCallback=function(){return navigator.geolocation?navigator.geolocation.getCurrentPosition(i.mapPanFromNavigation):!1},i.mapPanFromNavigation=function(e){i.mapPan(e.coords.latitude,e.coords.longitude)},i.mapPan=function(e,o){var t=new google.maps.LatLng(e,o);i.mainMap.panTo(t)},i.modelConstructor=function(e){for(var o in i.APIMappingsForModel)for(var t=i.APIMappingsForModel[o],r=0;r<t.length;r++)1===t[r].oType?e[t[r].model]=ko.observable():2===t[r].oType&&(e[t[r].model]=ko.observableArray([]))},i.modelDeconstructor=function(e){var o={};for(var t in i.APIMappingsForModel)for(var r=i.APIMappingsForModel[t],n=0;n<r.length;n++)0===r[n].oType?o[r[n].model]=e[r[n].model]:o[r[n].model]=e[r[n].model]();return o},i.modelUpdater=function(e,o,t){currentType=i.APIMappingsForModel[o];for(var r=0;r<currentType.length;r++)"undefined"!=typeof t[currentType[r].server]&&(0!==currentType[r].oType?e[currentType[r].model](t[currentType[r].server]):e[currentType[r].model]=t[currentType[r].server])},i.modelRebuilder=function(e,o,t){for(var r in i.APIMappingsForModel)for(var n=i.APIMappingsForModel[r],a=0;a<n.length;a++)if(0!==n[a].oType&&"google_geometry"!==n[a].model)e[n[a].model](o[n[a].model]);else if("google_geometry"===n[a].model){var l=o[n[a].model];l.location=t,e[n[a].model](l)}else e[n[a].model]=o[n[a].model]},i.modelSearchTypeConstructor=function(e){for(var o=0;o<i.APIConfiguredSearchTypes.length;o++)e[i.APIConfiguredSearchTypes[o].toLowerCase()+"SearchType"]=ko.observable("None"),e[i.APIConfiguredSearchTypes[o].toLowerCase()+"IsLoading"]=ko.observable(!1)},i.removeMultipleLocations=r(function(e){i.markedLocations.sort(function(e,o){return e.isFavorite()===!0?1:e.modelNumber<o.modelNumber?-1:1});for(var o=0;o<appConfigObject.markerLimitRemoveBulkAmount;o++)e[o].dispose();i.markedLocations.splice(0,appConfigObject.markerLimitRemoveBulkAmount)},1e3,{trailing:!1}),i.getLocationModelNumber=function(){return i.locationModelNumber++,i.locationModelNumber-1},i.setLocalStorage=r(function(e,o){i.storageAvailable===!0&&localStorage.setItem(e,o)},1e3,{trailing:!1}),i.locationArrayForWorkers=function(){return ko.utils.arrayMap(i.listableEntries(),function(e){return{lat:e.google_geometry().location.lat(),lng:e.google_geometry().location.lng(),name:e.google_name(),google_placeId:e.google_placeId}})},i.isSearchFiltered=function(e){return"undefined"!=typeof i.searchQuery()?e.google_name().toLowerCase().indexOf(i.searchQuery().toLowerCase())>=0?!1:!0:!1},i.isButtonFiltered=function(e){if(i.priceButtonFilterHasChanged()===!0)if("undefined"!=typeof e.google_priceLevel()){for(var o=0;5>o;o++)if(i.priceButtonFilter()[o]!==!0&&e.google_priceLevel()===o)return!0}else if(i.priceButtonFilter()[0]!==!0)return!0;if(0!==i.minRatingButtonFilter()){if("undefined"==typeof e.google_rating())return!0;if(e.google_rating()<i.minRatingButtonFilter())return!0}return i.openButtonFilter()!==!1&&"Open"!==e.isItOpenRightNow()?!0:i.favoriteButtonFilter()!==!1&&e.isFavorite()!==!0?!0:!1},i.scrollToItem=function(){"undefined"!=typeof i.currentlySelectedLocation()&&i.shouldScroll()===!0&&i.scrolledItem(i.currentlySelectedLocation())},i.makeInfoWindowContent=function(){var e=i.infoWindowHTMLTemplate;return e=$.parseHTML(e)[0]},i.checkIfOnMap=function(e){ko.utils.arrayForEach(i.markedLocations(),function(o){e.contains(o.google_geometry().location)===!1?o.isInViewOnMap(!1):o.isInViewOnMap(!0)})},i.compareIDs=function(e){return ko.utils.arrayFirst(i.markedLocations(),function(o){return o.google_placeId===e})},i.successAPIFunction=function(e,o,t,r,a,l,s){var c;if(c="undefined"!=typeof a?"basic":"detailed","basic"===c){var u=n(e,o.google_name());"number"==typeof u?(t(o),i.modelUpdater(o,r,e[u]),e.splice(u,1)):(t(o,"Not Found"),i.failAPIFunction(r.toProperCase()+" Search Problem","No Match Found",void 0,!0));var d={resultsArray:e,locationsArray:a,initialPoint:l,maxDistance:appConfigObject.latLngAccuracy,service:r,minFuzzyMatch:appConfigObject.minFuzzyMatch,workerHandler:s};i.workerHandler(d,r,t)}else t(o),i.modelUpdater(o,r,e)},i.failAPIFunction=function(e,o,t,r){"undefined"==typeof r&&(r=!1);var n={};n.customMessage=e,n.textStatus=o,n.verbose=r,i.errors(n),t&&console.warn(t)},i.getDetailedAPIData=function(e,o){"None"===o.searchType(e)()?(-1===i.currentDetailedAPIInfoBeingFetched.findID(e,"basic",o)&&i.callBasicAPIData(e,o),i.currentDetailedAPIInfoBeingFetched.interceptIDPush(e,"detailed",o)):"Basic"===o.searchType(e)()&&-1===i.currentDetailedAPIInfoBeingFetched.findID(e,"detailed",o)&&(i.currentDetailedAPIInfoBeingFetched.pushID(e,"detailed",o),i.callAPIInfo("detailed",e,o))},i.callSearchAPIs=function(e){for(var o=ko.toJS(i.locationArrayForWorkers()),t=0;t<i.APIConfiguredSearchTypes.length;t++){var r=i.APIConfiguredSearchTypes[t];"None"===e.searchType(r)()&&-1===i.currentDetailedAPIInfoBeingFetched.findID(r,"basic",e)&&i.callBasicAPIData(r,e,o)}},i.callBasicAPIData=function(e,o,t){"undefined"==typeof t&&(t=ko.toJS(i.locationArrayForWorkers())),i.currentDetailedAPIInfoBeingFetched.pushID(e,"basic",o),i.callAPIInfo("basic",e,o,t)},i.checkAndAddFullAttributions=function(e){for(var o=[],t=0;t<e.length;t++)-1===i.attributionsArray.indexOf(e[t])&&o.push(e[t]);i.attributionsArray.push.apply(i.attributionsArray,o)},i.processNearbyResults=function(e,o,t,r){if(o!==google.maps.places.PlacesServiceStatus.OK)return void i.failAPIFunction("Google Maps Nearby Search Error",o);for(var n=[],a=0;a<e.length;a++)if(-1===i.idArray().nearby.indexOf(e[a].place_id)){if(-1===i.idArray().all.indexOf(e[a].place_id)){var l=new f(i,"Nearby");i.successAPIFunction(e[a],l,function(){},"google"),n.push(l)}else{var s=i.compareIDs(e[a].place_id);s&&i.successAPIFunction(e[a],s,i.setAPIResultSearchType("Nearby","google").setSearchType,"google")}0!==e[a].html_attributions.length&&i.checkAndAddFullAttributions(e[a].html_attributions)}i.markedLocations.push.apply(i.markedLocations,n),t&&t.hasNextPage&&setTimeout(function(){i.getRestaurantsFromGoogleMapsAPICallArray[r]===!0&&t.nextPage()},2e3)},i.processRadarResults=function(e,o){if(o!==google.maps.places.PlacesServiceStatus.OK)return void i.failAPIFunction("Google Maps Radar Search Error",o);for(var t=[],r=0;r<e.length;r++){if(-1===i.idArray().all.indexOf(e[r].place_id)){var n=new f(i,"Radar");i.successAPIFunction(e[r],n,function(){},"google"),t.push(n)}0!==e[r].html_attributions.length&&i.checkAndAddFullAttributions(e[r].html_attributions)}i.markedLocations.push.apply(i.markedLocations,t)},i.getRestaurantsFromGoogleMapsAPI=function(e){var o=i.mainMap.getBounds(),t={bounds:o,types:["restaurant"]};i.service.radarSearch(t,i.processRadarResults),i.service.nearbySearch(t,function(o,t,r){i.processNearbyResults(o,t,r,e)})},i.getDetailedGooglePlacesAPIInfo=function(e,o){-1===i.currentDetailedAPIInfoBeingFetched.findID("google","detailed",e)&&(i.currentDetailedAPIInfoBeingFetched.pushID("google","detailed",e),i.service.getDetails({placeId:e.google_placeId},function(t,r){return i.currentDetailedAPIInfoBeingFetched.removeID("google","detailed",e),r!==google.maps.places.PlacesServiceStatus.OK?void i.failAPIFunction("Google Places Search Error",r):(i.successAPIFunction(t,e,i.setAPIResultSearchType("Places","google").setSearchType,"google"),void o(e))}))},i.setAPIResultSearchType=function(e,o){function t(e,o){var t=r.type.toProperCase();o&&(t=o),e.searchType(r.service)(t)}var r={type:e,service:o};return{setSearchType:t}},i.callAPIInfo=function(e,o,t,r,n){var a,l,s,c=appConfigObject[o+"_searchAPIProperties"],u=c.settings;if(u.url=c[e+"_URL"],"basic"!==e&&(u.url+=t[o+"_id"](),c.extraSlash===!0&&(u.url+="/")),"basic"===e){a=t.google_geometry().location.lat(),l=t.google_geometry().location.lng(),s={lat:a,lng:l};for(var d in c.basicExtraParameters)"function"==typeof c.basicExtraParameters[d]?u.data[d]=c.basicExtraParameters[d](a,l):u.data[d]=c.basicExtraParameters[d]}for(var p in c.allExtraParameters)u.data[p]=c.allExtraParameters[p](u.url,u.data);u.success=function(n){var a=n;if("object"==typeof c[e+"_returnType"])for(var l=0;l<c[e+"_returnType"].length;l++)a=a[c[e+"_returnType"][l]];else a="undefined"!=typeof c[e+"_returnType"]?a[c[e+"_returnType"]]:n;"undefined"!=typeof a?i.successAPIFunction(a,t,i.setAPIResultSearchType(e,o).setSearchType,o,r,s,c.workerHandler):(i.currentDetailedAPIInfoBeingFetched.interceptIDRemove(t),console.debug(n),i.failAPIFunction(o.toProperCase()+" "+e.toProperCase()+" Search Error","Could not interpret results"))},u.error=function(r,n,a){i.currentDetailedAPIInfoBeingFetched.interceptIDRemove(t),i.failAPIFunction(o.toProperCase()+" "+e.toProperCase()+" Search Error",n,a)},u.complete=function(r,n){i.currentDetailedAPIInfoBeingFetched.removeID(o,e,t)},$.ajax(u),"function"==typeof n&&n()},i.getGooglePhotoURL=function(e,o){return"function"==typeof e.getUrl?e.getUrl(o):""},i.avoidMemeoryLeaksDueToEventListeners=function(e){e=void 0},i.workerHandler=function(e,o,t){if(i.workersAvailable===!0){var r=new Worker("/js/workerFillMarkerData.js");r.onmessage=function(e){returnObject=e.data;for(var n=0;n<returnObject.length;n++){var a=i.compareIDs(returnObject[n].google_placeId);t(a),i.modelUpdater(a,o,returnObject[n])}i.avoidMemeoryLeaksDueToEventListeners(r)},r.postMessage(e)}},i.getLocalStorage=function(){if(i.storageAvailable===!0){if(localStorage.getItem("favoritesArray")){var e=JSON.parse(localStorage.getItem("favoritesArray"));if(null!==e){for(var o=[],t=0;t<e.length;t++){var r=new f(i,"Nearby"),n=Number(e[t].google_geometry.location.lat),a=Number(e[t].google_geometry.location.lng),l=new google.maps.LatLng(n,a);i.modelRebuilder(r,e[t],l),r.google_geometry(r.google_geometry()),r.isFavorite(!0),r.google_openingHoursObject(void 0),o.push(r)}i.markedLocations.push.apply(i.markedLocations,o)}}if(localStorage.getItem("mapCenter")){var s=JSON.parse(localStorage.getItem("mapCenter"));null!==s&&"undefined"!=typeof s.lat&&null!==s.lat&&(i.mapPan(s.lat,s.lng),null!==s.zoom&&"number"==typeof s.zoom&&i.mainMap.setZoom(s.zoom))}}},i.singleErrorMessages=function(){i.storageAvailable!==!0&&i.failAPIFunction("Local Storage Problem","Local Storage support is not available. Favorites will not save after page reload."),i.workersAvailable!==!0&&i.failAPIFunction("Web Workers Problem","Web Workers support is not available. App will function normally but average data retrieval wait times will increase. \n Web workers do not work when loading this application from older browsers or directly from the local file system.")},i.initializeCurrentDetailedAPIInfoBeingFetched(),i.singleErrorMessages(),i.getLocalStorage()}function b(){var o={google:{families:["Lato:400,400italic,700:latin","Scheherazade:400,700:latin"]},timeout:1e4,active:function(){w=!0},inactive:function(){fontPreloaded=!0}};WebFont.load(o),e(["img/marker-1.png","img/marker-2.png","img/marker-3.png","img/marker-4.png","img/marker-empty.png","img/marker-heart.png"],function(){A=!0}),h()}function v(){alert("Google Maps failed to load. Please try again later.")}function y(){P=!0}function h(){$.doWhen({when:function(){return A===!0&&w===!0&&P===!0}}).done(function(){k(),$("#loading").fadeOut(500)})}function k(){if("undefined"==typeof google)v();else{var e=new google.maps.LatLng(appConfigObject.defaultLat,appConfigObject.defaultLng),o=appConfigObject.defaultZoom,t=document.getElementById("mapDiv"),n=appConfigObject.mapStyle,a={center:e,zoom:o,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{mapTypeIds:[]},styles:n},i=new google.maps.MarkerImage("img/reticle.png",new google.maps.Size(16,16),new google.maps.Point(0,0),new google.maps.Point(8,8)),l={coords:[8,8,8,8],type:"rect"},s=new google.maps.Map(t,a),c=new m(s);ko.applyBindings(c,document.body),reticleMarker=new google.maps.Marker({position:s.getCenter(),map:s,icon:i,shape:l,optimized:!1,zIndex:5});var u=r(function(e){reticleMarker.setPosition(e)},16,{leading:!1}),d=r(function(){"undefined"!=typeof c.getRestaurantsFromGoogleMapsAPICallArray[c.getRestaurantsFromGoogleMapsAPICallArray.length-1]&&(c.getRestaurantsFromGoogleMapsAPICallArray[c.getRestaurantsFromGoogleMapsAPICallArray.length-1]=!1),c.getRestaurantsFromGoogleMapsAPICallArray.push(!0),c.getRestaurantsFromGoogleMapsAPI(c.getRestaurantsFromGoogleMapsAPICallArray.length-1)},1200,{trailing:!1}),p=r(function(e){c.checkIfOnMap(c.mainMap.getBounds()),c.mainMapCenter(e),d()},50,{leading:!1});google.maps.event.addListener(s,"bounds_changed",function(){var e=s.getCenter();p(e),u(e)}),c.storageAvailable===!0?(mapCenter=JSON.parse(localStorage.getItem("mapCenter")),localStorage.getItem("mapCenter")&&"undefined"!=typeof mapCenter.lat&&null!==mapCenter.lat||c.getNavWithCallback()):c.getNavWithCallback()}}String.prototype.toProperCase=function(){return this.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},_now=Date.now||function(){return(new Date).getTime()};var I=r(function(e){e.perfectScrollbar("update")},16,{leading:!1});ko.bindingHandlers.ko_autocomplete={init:function(e,o,t,r,n){$(e).autocomplete(o())},update:function(e,o,t,r,n){$(e).autocomplete({source:function(e,t){var r=$.ui.autocomplete.filter(o().source,e.term);t(r.slice(0,6))},select:function(e,o){t().textInput(o.item.value)}})}},ko.bindingHandlers.addressAutocomplete={init:function(e,o,t,r,n){var a=(o(),t()),i=n.$data.mainMap,l={types:["geocode"]};ko.utils.extend(l,a.autocompleteOptions);var s=new google.maps.places.Autocomplete(e,l);s.bindTo("bounds",i),s.addListener("place_changed",function(){var e=s.getPlace();e.geometry&&(e.geometry.viewport?i.fitBounds(e.geometry.viewport):(i.setCenter(e.geometry.location),i.setZoom(appConfigObject.defaultZoom)))})},update:function(e,o,t){ko.bindingHandlers.value.update(e,o())}},ko.bindingHandlers.ko_slideOutMenu={init:function(e,o){$.slidebars()}},ko.bindingHandlers.scrollTo={update:function(e,o,t){var n=o(),a=ko.unwrap(n);if(a){var i=r(function(){$(e).scrollintoview({duration:100})},50);i()}}},ko.bindingHandlers.hoverToggle={init:function(e,o,t,r,n){ko.utils.registerEventHandler(e,"mouseover",function(){n.$data.shouldScroll(!1),$(e).stop(!1,!0)})}},ko.bindingHandlers.ko_slider={init:function(e,o,t,r,n){ko.bindingHandlers.value.init(e,o,t,r,n);var a=o();a.value=o().value(),$(e).slider(a).on("slidechange",function(e,t){o().value(t.value)})}},ko.bindingHandlers.ko_rateit={init:function(e,o,t,r,n){$(e).bind("reset",function(){o().value(0)})}},ko.bindingHandlers.ko_styleInfoWindow={init:function(e,o,t,r,n){for(var a,i,l=$(e).parent().parent().addClass("custom-info-window-subcontainer"),s=l.siblings(),c=0;c<s.length;c++)if("0px"===$(s[c]).css("top")){a=$(s[c]).addClass("custom-info-window-background-container").children();break}if(a){for(var u=0;u<a.length;u++)if("rgb(255, 255, 255)"===$(a[u]).css("background-color")){i=$(a[u]).addClass("custom-info-window-background");break}if(i){l.parent().parent().parent().addClass("custom-info-window");i.css({"background-color":"","border-radius":""})}}}},ko.bindingHandlers.ko_bootstrapTooltip={init:function(e,o,t,r,n){$('[data-toggle="tooltip"]').tooltip({container:"body"})}},ko.bindingHandlers.ko_perfectScrollbar={init:function(e,o,t,r,n){$(e).perfectScrollbar(),$(e).bind("mouseenter",function(o){p(o,e)})},update:function(e,o,t,r,n){ko.utils.unwrapObservable(o());I($(e))}},ko.bindingHandlers.generateStars={update:function(e,o,t,r,n,a){var i;i="function"==typeof o?ko.unwrap(o()):o;for(var l=Math.floor(i),s=i-l,c="",u=1;i>=u;u++)c+='<span class="glyphicon glyphicon-star" aria-hidden="true"></span>';if(s>0&&(c+='<span class="glyphicon glyphicon-star partial-width-'+Math.round(10*s)+'" aria-hidden="true"></span>'),""!==c){if(a===!0)return c;$(e).html(c)}}},ko.bindingHandlers.obToImg={update:function(e,o,t,r,n,a){var i;i="function"==typeof o?ko.unwrap(o()):o;var l="";if("undefined"!=typeof i&&(l+='<img src="'+i+'" alt="observable">'),""!==l){if(a===!0)return l;$(e).html(l)}}},ko.bindingHandlers.generateUSD={update:function(e,o,t,r,n,a){var i;i="function"==typeof o?ko.unwrap(o()):o;for(var l="",s=1;i>=s;s++)l+='<i class="fa fa-usd"></i>';if(""!==l){if(a===!0)return l;$(e).html(l)}}},ko.bindingHandlers.ko_modal={init:function(e,o,t,r,n){var a=ko.unwrap(o());ko.utils.registerEventHandler(e,"click",function(){$(a).modal()})}},ko.bindingHandlers.menuToggle={init:function(e,o,t,r,n){var a=ko.unwrap(o());ko.utils.registerEventHandler(e,"click",function(){$(e).toggleClass("mobile-button-pressed"),$("#"+a).toggleClass("panel-visible"),$(e).trigger("mouseleave")})}},ko.bindingHandlers.scrollToItem={update:function(e,o,t,r,n){ko.utils.unwrapObservable(o());n.$data.scrollToItem()}},ko.bindingHandlers.infoWindowTemplate={init:function(e,o,t,r,n){$(e).prev().hasClass("info-window-loaded")||ko.renderTemplate("info-window-template-container",n.$data,{},e,"replaceNode")}},ko.bindingHandlers.errorsHandler={update:function(e,o,t,r,n){var a=o().data();if(a!==!1){o().data(!1);var i=o().verbose(),l=a.verbose;if(i===!0||l===!1){var s=a.customMessage,c=a.textStatus,p='<div class="panel ';p+=l===!0?"panel-warning":"panel-danger",p+='"><div class="panel-heading"><h3 class="panel-title">',p+=s,p+='</h3></div><div class="panel-body">',p+=c,p+="</div></div>",$("#error-container").append(p);var g=$("#error-container").children().last();g.show(200),g.bind("click",d),l===!0&&setTimeout(function(){u(g,200)},3e3)}}}},ko.bindingHandlers.listOutOpeningHours={update:function(e,t,r,n,a){var i=ko.unwrap(t());if("undefined"!=typeof i&&o(i,"weekday_text","0")!==!1){for(var l="",s=0;s<i.weekday_text.length;s++)l+="<div>"+i.weekday_text[s]+"</div>";e.innerHTML=l}}},ko.bindingHandlers.dropdown={init:function(e,o,t,r,n){$(e).on("shown.bs.dropdown",function(){var e=$(this).find(".dropdown-menu");if(null!==e&&1===e.length){var o=e.parent(),t=$("#info-window-template");e.position({of:o,my:"left top",at:"left bottom",collision:"flip",within:t})}})},update:function(e,o,t,r,n){var a=o().data,i='<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret caret-dropdown"></span></button><ul class="dropdown-menu dropdown-menu-right">',l=i;for(var s in a){var u;if(u="undefined"!=typeof a[s].value_binding?c(a[s].value,a[s].value_binding,e,t,r,n):c(a[s].value),u!==!1){if(l+="<li><strong>"+s+":</strong> <span>"+u+"</span>","undefined"!=typeof a[s].value_binding_show_text&&(l+=" ("+c(a[s].value)+")"),"undefined"!=typeof a[s].value_2)if("undefined"!=typeof a[s].value_3)for(var d=2;"undefined"!=typeof a[s]["value_"+d];){var p=c(a[s]["value_"+d]);p!==!1&&(l+=2===d?"("+p+")":", "+p,"undefined"==typeof a[s]["value_"+(d+1).toString()]&&"undefined"!=typeof a[s].append&&(l+=a[s].append)),d++}else{var g=c(a[s].value_2);g!==!1&&(l+=", "+g,"undefined"!=typeof a[s].append&&(l+=a[s].append))}l+="</li>"}}l!==i&&(l+="</ul>",e.innerHTML=l),$(e).hasClass("open")&&$(e).trigger("shown.bs.dropdown")}},ko.extenders.numeric=function(e,o){var t=ko.computed({read:function(){var t=Number(e()).toFixed(o)/1;return t},write:e});return t};var A=!1,w=!1,P=!1;return{googleLoaded:y,googleFailedToLoad:v,preloadFontsAndImages:b}}();